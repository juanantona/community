Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =7370
    DatasheetFontHeight =11
    ItemSuffix =53
    Left =3225
    Top =2415
    Right =24945
    Bottom =14565
    DatasheetGridlinesColor =14806254
    RecSrcDt = Begin
        0x60d7bae5dddfe440
    End
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ListBox
            AddColon = NotDefault
            BorderLineStyle =0
            Height =454
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Subform
            BorderLineStyle =0
            Width =1701
            Height =1701
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin EmptyCell
            Height =240
            GridlineColor =12632256
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin NavigationControl
            BorderWidth =1
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin FormHeader
            Height =963
            BackColor =15849926
            Name ="EncabezadoDelFormulario"
            AutoHeight =1
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =2
            BackTint =20.0
            Begin
                Begin Label
                    OverlapFlags =85
                    Left =737
                    Top =113
                    Width =6066
                    Height =850
                    FontSize =16
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="Etiqueta5"
                    Caption ="COMUNIDAD 11"
                    GridlineColor =10921638
                    LayoutCachedLeft =737
                    LayoutCachedTop =113
                    LayoutCachedWidth =6803
                    LayoutCachedHeight =963
                End
            End
        End
        Begin Section
            Height =6349
            Name ="Detalle"
            AlternateBackColor =15921906
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
            Begin
                Begin Subform
                    OverlapFlags =85
                    Left =1695
                    Top =360
                    Width =5235
                    Height =1695
                    BorderColor =10921638
                    Name ="Secundario0"
                    SourceObject ="Form.sfrmMembersDataView"
                    GroupTable =1
                    BottomPadding =150
                    GridlineColor =10921638

                    LayoutCachedLeft =1695
                    LayoutCachedTop =360
                    LayoutCachedWidth =6930
                    LayoutCachedHeight =2055
                    ColumnStart =1
                    ColumnEnd =1
                    LayoutGroup =1
                    GroupTable =1
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =360
                            Top =360
                            Width =1275
                            Height =1695
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Etiqueta1"
                            Caption ="Hermanos:"
                            GroupTable =1
                            BottomPadding =150
                            GridlineColor =10921638
                            LayoutCachedLeft =360
                            LayoutCachedTop =360
                            LayoutCachedWidth =1635
                            LayoutCachedHeight =2055
                            LayoutGroup =1
                            GroupTable =1
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =5100
                    Top =2490
                    Width =1834
                    Height =348
                    TabIndex =1
                    ForeColor =4210752
                    Name ="cmdShowBrothers"
                    Caption ="Generar grupos"
                    OnClick ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =5100
                    LayoutCachedTop =2490
                    LayoutCachedWidth =6934
                    LayoutCachedHeight =2838
                    BackColor =14136213
                    BorderColor =14136213
                    HoverColor =15060409
                    PressedColor =9592887
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1713
                    Top =3401
                    Width =5101
                    Height =2550
                    TabIndex =2
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="txtGroups"
                    GridlineColor =10921638

                    LayoutCachedLeft =1713
                    LayoutCachedTop =3401
                    LayoutCachedWidth =6814
                    LayoutCachedHeight =5951
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =453
                            Top =3401
                            Width =705
                            Height =315
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Etiqueta8"
                            Caption ="Grupos"
                            GridlineColor =10921638
                            LayoutCachedLeft =453
                            LayoutCachedTop =3401
                            LayoutCachedWidth =1158
                            LayoutCachedHeight =3716
                        End
                    End
                End
                Begin ComboBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =1440
                    Left =4204
                    Top =2494
                    Width =671
                    Height =315
                    TabIndex =3
                    BorderColor =10921638
                    ForeColor =4138256
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"4\";\"4\""
                    Name ="ctrNumbers"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lstNumbers.Id, lstNumbers.Number FROM lstNumbers ORDER BY lstNumbers.[Id]"
                        "; "
                    ColumnWidths ="1441"
                    GridlineColor =10921638

                    LayoutCachedLeft =4204
                    LayoutCachedTop =2494
                    LayoutCachedWidth =4875
                    LayoutCachedHeight =2809
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =396
                            Top =2494
                            Width =3405
                            Height =320
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Número de personas en cada grupo_Etiqueta"
                            Caption ="Número de personas en cada grupo"
                            EventProcPrefix ="Número_de_personas_en_cada_grupo_Etiqueta"
                            GridlineColor =10921638
                            LayoutCachedLeft =396
                            LayoutCachedTop =2494
                            LayoutCachedWidth =3801
                            LayoutCachedHeight =2814
                        End
                    End
                End
            End
        End
        Begin FormFooter
            Height =0
            Name ="PieDelFormulario"
            AutoHeight =1
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database

Private Sub cmdShowBrothers_Click()
  Dim cntCurrentDB As ADODB.Connection
  Dim rsoMembers As ADODB.recordset
  Dim strGroup As String
  
  'Instancia conexión a BD actual
   Set cntCurrentDB = CurrentProject.Connection
   Set rsoMembers = New ADODB.recordset
   rsoMembers.Open "SELECT * FROM lstMembers", cntCurrentDB, adOpenKeyset, adLockOptimistic
   
   Dim strm As ADODB.Stream
   Set strm = New ADODB.Stream
   rsoMembers.Save strm
   Dim rsoCopy As ADODB.recordset
   Set rsoCopy = New ADODB.recordset
   rsoCopy.Open strm
   
   Dim groupNumber As Integer
   Dim groupMember As Integer
   
   
   groupMember = ctrNumbers
   groupNumber = getNumberOfGroups(rsoCopy.RecordCount, groupMember)
   
   Dim i, j, k, rd As Integer
   
   txtGroups.SetFocus
   txtGroups.Text = ""
    
   For i = 1 To groupNumber
     For j = 1 To groupMember
       k = 1
       rd = random(rsoCopy.RecordCount)
       If (rsoCopy.RecordCount = 0) Then Exit For
       rsoCopy.MoveFirst
       Do Until rsoCopy.EOF = True
         If k = rd Then
           strGroup = strGroup & rsoCopy.Fields!FirstNameField & ", "
           rsoCopy.Delete
         End If
         rsoCopy.MoveNext
         k = k + 1
       Loop
       
    Next j
    txtGroups.SetFocus
    strGroup = vbCrLf & strGroup
    txtGroups.Text = txtGroups.Text & strGroup
    strGroup = ""
   Next i
      
   Set rsoMembers = Nothing
   cntCurrentDB.Close

End Sub

Public Function random(recorCount As Integer) As Integer
  Randomize
  random = Int(recorCount * Rnd) + 1
End Function

Public Function getNumberOfGroups(totalMembersCount As Integer, membersCountEachGroup As Integer) As Integer
  getNumberOfGroups = Round(totalMembersCount / membersCountEachGroup)
End Function
